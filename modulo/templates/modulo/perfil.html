{% extends 'modulo/base.html' %}
{% block title %}Mi Perfil{% endblock %}

{% block content %}
<h2 class="mb-4">Mi Perfil - {{ user.username }}</h2>

<h4>üìñ Libros guardados:</h4>
<div class="row">
    {% for libro in favoritos %}
        <div class="col-md-4 mb-3">
            <div class="card">
                {% if libro.portada %}
                    <img src="{{ libro.portada }}" class="card-img-top" style="height: 200px; object-fit: cover;">
                {% endif %}
                <div class="card-body">
                    <h5 class="card-title">{{ libro.titulo }}</h5>
                    <p class="card-text">{{ libro.autor }}</p>
                    <a href="{{ libro.link }}" target="_blank" class="btn btn-sm btn-outline-primary">Ver online</a>
                    <a href="{% url 'eliminar_libro' libro.id %}" class="btn btn-sm btn-danger">Eliminar</a>
                    <a href="{% url 'comentarios_libro' titulo_slug=libro.titulo|slugify autor_slug=libro.autor|slugify %}" 
                       class="btn btn-warning btn-sm position-relative">
                        <i class="bi bi-chat-dots"></i> Comentar
                        {% if libro.num_comentarios > 0 %}
                        <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-dark">
                            {{ libro.num_comentarios }}
                        </span>
                        {% endif %}
                    </a>
                </div>
            </div>
        </div>
    {% empty %}
        <p>No tienes libros guardados a√∫n.</p>
    {% endfor %}
</div>

<hr>

<h4>üîç Historial de b√∫squedas:</h4>
<ul class="list-group">
    {% for h in historial %}
        <li class="list-group-item">
            {{ h.termino }}
            <span class="text-muted float-end">{{ h.fecha|date:"SHORT_DATETIME_FORMAT" }}</span>
        </li>
    {% empty %}
        <li class="list-group-item">No hay b√∫squedas recientes.</li>
    {% endfor %}
</ul>
{% endblock %}

